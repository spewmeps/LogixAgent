# ftrace æ—¥å¿—åˆ†ææ–¹æ³•è®º

> **æ ¸å¿ƒç†å¿µ**ï¼šæŠŠ ftrace å½“æˆå†…æ ¸çº§æ—¶åºæ˜¾å¾®é•œï¼Œé‡ç‚¹ä¸æ˜¯"æŠ“äº†ä»€ä¹ˆ"ï¼Œè€Œæ˜¯**å¦‚ä½•æŠŠæµ·é‡äº‹ä»¶è¿˜åŸæˆå› æœé“¾**ã€‚

---

## ä¸€ã€æ ¸å¿ƒåŸåˆ™ï¼ˆå…ˆç«‹è§„çŸ©ï¼‰

### 1ï¸âƒ£ å…ˆæœ‰é—®é¢˜ï¼Œå†çœ‹æ—¥å¿—

ftrace ä¸æ˜¯ç”¨æ¥"æ‰«ä¸€çœ¼çœ‹çœ‹å‘ç”Ÿäº†å•¥"ï¼Œè€Œæ˜¯ç”¨æ¥**éªŒè¯å‡è®¾**ã€‚

**æ­£ç¡®é¡ºåº**ï¼š
```
ç°è±¡ â†’ å‡è®¾ â†’ è¯æ®ï¼ˆftraceï¼‰â†’ ç»“è®º
```

**é”™è¯¯é¡ºåº**ï¼š
```
æ—¥å¿— â†’ æ‰¾å¼‚å¸¸ â†’ çŒœåŸå› 
```

**å®è·µå»ºè®®**ï¼š
- åœ¨æŸ¥çœ‹æ—¥å¿—å‰ï¼Œå…ˆå†™ä¸‹ä½ çš„å‡è®¾
- æ˜ç¡®è¦éªŒè¯ä»€ä¹ˆï¼Œè€Œä¸æ˜¯"çœ‹çœ‹æœ‰ä»€ä¹ˆ"
- å¦‚æœæ—¥å¿—ä¸æ”¯æŒå‡è®¾ï¼Œè¯´æ˜å‡è®¾é”™äº†ï¼Œè€Œéæ—¥å¿—ä¸å…¨

---

### 2ï¸âƒ£ æ—¶é—´å› æœä¼˜å…ˆäºå‡½æ•°ç»†èŠ‚

åœ¨ ftrace ä¸­ï¼š
- **æ—¶é—´å…³ç³» > è°ƒç”¨å…³ç³»**
- **è°å…ˆã€è°å > è°è°ƒç”¨è°**

**ä»»ä½•åˆ†æéƒ½å¿…é¡»å›ç­”**ï¼š
1. äº‹ä»¶ A æ˜¯å¦å¯¼è‡´äº†äº‹ä»¶ Bï¼Ÿ
2. B æ˜¯å¦å‘ç”Ÿåœ¨ A ä¹‹åçš„åˆç†æ—¶é—´çª—å£ï¼Ÿ

**åæ¨¡å¼**ï¼š
- âŒ "è¿™é‡Œè°ƒç”¨äº†å‡½æ•° Xï¼Œæ‰€ä»¥é—®é¢˜æ˜¯ X"
- âœ… "A å‘ç”Ÿå 50msï¼ŒB ä»æœªæ‰§è¡Œï¼ŒæœŸé—´ C å ç”¨äº† CPU"

---

### 3ï¸âƒ£ æ°¸è¿œæ²¿"è°ƒåº¦è§†è§’"å±•å¼€

æ— è®ºåˆ†æä»€ä¹ˆé—®é¢˜ï¼ˆå¡é¡¿ã€æ€§èƒ½ã€é”ã€ä¸­æ–­ï¼‰ï¼Œæœ€ç»ˆéƒ½å›å½’ä¸‰ä¸ªé—®é¢˜ï¼š

1. **çº¿ç¨‹æ˜¯å¦ runnableï¼Ÿ**ï¼ˆæƒ³è¿è¡Œä½†è¿˜æ²¡è½®åˆ°ï¼‰
2. **çº¿ç¨‹æ˜¯å¦ runningï¼Ÿ**ï¼ˆæ­£åœ¨è¿è¡Œï¼‰
3. **æ˜¯è°é˜»æ­¢äº†å®ƒ runningï¼Ÿ**ï¼ˆè¢«è°æŒ¡äº†ï¼‰

**è®°ä½**ï¼šå†…æ ¸ä¸­çš„ä¸€åˆ‡é—®é¢˜ï¼Œæœ€ç»ˆéƒ½æ˜¯"è°åœ¨ä»€ä¹ˆæ—¶å€™æ²¡èƒ½è¿è¡Œ"çš„é—®é¢˜ã€‚

---

## äºŒã€æ—¥å¿—æ‹†è§£çš„é€šç”¨ç»“æ„

æŠŠ ftrace æ—¥å¿—ç»Ÿä¸€æŠ½è±¡ä¸ºå››ç±»äº‹ä»¶ï¼š

### 1. çŠ¶æ€å˜åŒ–
- runnable â†” running â†” blocked
- è¿™æ˜¯æœ€åŸºç¡€çš„ä¿¡æ¯

### 2. æŠ¢å /æ‰“æ–­
- è°ƒåº¦åˆ‡æ¢ï¼ˆsched_switchï¼‰
- ä¸­æ–­ / è½¯ä¸­æ–­ï¼ˆirq_handler_entry, softirq_entryï¼‰

### 3. å› æœè§¦å‘
- wakeupï¼ˆå”¤é†’ï¼‰
- èµ„æºé‡Šæ”¾ï¼ˆunlock, signalï¼‰

### 4. èƒŒæ™¯å™ªå£°
- ä¸é—®é¢˜æ— ç›´æ¥å› æœçš„å¹¶å‘è¡Œä¸º
- **è¿™æ˜¯ 80% çš„æ—¥å¿—å†…å®¹**

**æ–¹æ³•è®ºé‡ç‚¹**ï¼š
> åªä¿ç•™èƒ½æ„æˆå› æœé“¾çš„äº‹ä»¶ï¼Œå…¶ä½™éƒ½æ˜¯å™ªå£°

**å®è·µæŠ€å·§**ï¼š
- å…ˆç”¨ `--filter-pid` æˆ– `--filter-cpu` å‡å°‘å™ªå£°
- åªå…³æ³¨å¼‚å¸¸æ—¶é—´çª—å£å†…çš„äº‹ä»¶
- å¿½ç•¥é¢‘ç‡æé«˜ä½†æ— å¼‚å¸¸çš„äº‹ä»¶ï¼ˆå¦‚å®šæ—¶å™¨ä¸­æ–­ï¼‰

---

## ä¸‰ã€åˆ†æä¸»çº¿ï¼šäº”æ­¥èµ°

### Step 1ï¼šé”šå®š"å¼‚å¸¸æ—¶é—´çª—"

**å…ˆç¡®å®š**ï¼š
- é—®é¢˜å¼€å§‹çš„æ—¶é—´ç‚¹
- é—®é¢˜ç»“æŸçš„æ—¶é—´ç‚¹

**è¿™ä¸ªæ—¶é—´çª—æ˜¯å”¯ä¸€å¯ä¿¡åˆ†æèŒƒå›´**ï¼Œçª—å¤–çš„æ—¥å¿—ä¸€å¾‹ä¸å‚ä¸ç»“è®ºã€‚

**å¦‚ä½•ç¡®å®šæ—¶é—´çª—**ï¼š
1. åº”ç”¨å±‚æ—¥å¿—çš„æ—¶é—´æˆ³
2. ç”¨æˆ·æŠ¥å‘Šçš„é—®é¢˜å‘ç”Ÿæ—¶é—´
3. ç›‘æ§ç³»ç»Ÿçš„å‘Šè­¦æ—¶é—´
4. å¯¹æ¯”æ­£å¸¸å’Œå¼‚å¸¸æ—¥å¿—ï¼Œæ‰¾åˆ°åˆ†ç•Œç‚¹

**å‘½ä»¤ç¤ºä¾‹**ï¼š
```bash
# æŸ¥çœ‹æ•´ä¸ªæ—¥å¿—çš„æ—¶é—´èŒƒå›´
scripts/ftrace_parser.py trace.txt --summary

# æå–å¼‚å¸¸æ—¶é—´çª—å£
scripts/ftrace_parser.py trace.txt \
  --time-range 1234.5,1237.8 \
  --output problem_window.txt
```

---

### Step 2ï¼šè¯†åˆ«"å—å®³çº¿ç¨‹"

**æ˜ç¡®**ï¼š
- å“ªä¸ªçº¿ç¨‹/ä»»åŠ¡çš„ä½“éªŒæ˜¯"å¼‚å¸¸"çš„
- å®ƒåœ¨å¼‚å¸¸çª—å£å†…çš„çŠ¶æ€å˜åŒ–

**å…³é”®ä¸æ˜¯"å®ƒåœ¨åšä»€ä¹ˆ"ï¼Œè€Œæ˜¯**ï¼š
> **å®ƒä»€ä¹ˆæ—¶å€™æ²¡èƒ½è¿è¡Œ**

**è¯†åˆ«æ–¹æ³•**ï¼š
```bash
# åˆ†æç›®æ ‡çº¿ç¨‹çš„çŠ¶æ€
scripts/sched_analyzer.py trace.txt --thread myapp

# æ‰¾å‡ºè°ƒåº¦å»¶è¿Ÿè¶…è¿‡é˜ˆå€¼çš„æ—¶åˆ»
scripts/sched_analyzer.py trace.txt --thread myapp --latency-threshold 10
```

**åˆ¤æ–­æ ‡å‡†**ï¼š
- æ­£å¸¸ï¼šrunnable â†’ running å»¶è¿Ÿ < 5ms
- å¯ç–‘ï¼šå»¶è¿Ÿ 5-20ms
- å¼‚å¸¸ï¼šå»¶è¿Ÿ > 20ms

---

### Step 3ï¼šè¿˜åŸè°ƒåº¦è·¯å¾„

**å¯¹è¯¥çº¿ç¨‹ï¼Œé¡ºåºå›ç­”**ï¼š
1. ä½•æ—¶å˜æˆ runnableï¼Ÿ
2. ä½•æ—¶çœŸæ­£ runningï¼Ÿ
3. ä¸­é—´æ˜¯å¦è¢«åå¤æŠ¢å æˆ–æ¨è¿Ÿï¼Ÿ

**ğŸ‘‰ runnable â†’ running ä¹‹é—´çš„æ—¶é—´ï¼Œå°±æ˜¯è°ƒåº¦å»¶è¿Ÿæœ¬ä½“**

**åˆ†æå‘½ä»¤**ï¼š
```bash
# æŸ¥çœ‹è¯¦ç»†çš„è°ƒåº¦è·¯å¾„
scripts/timeline_analyzer.py trace.txt --target myapp --context 100ms
```

**å…³é”®æŒ‡æ ‡**ï¼š
- **è°ƒåº¦å»¶è¿Ÿ**ï¼šrunnable åˆ° running çš„æ—¶é—´
- **æŠ¢å æ¬¡æ•°**ï¼šrunning â†’ runnable çš„æ¬¡æ•°
- **è¿è¡Œæ—¶é—´ç‰‡**ï¼šæ¯æ¬¡ running çš„æŒç»­æ—¶é—´

---

### Step 4ï¼šå¯»æ‰¾"é˜»æ–­è€…"

**å‡¡æ˜¯è®©ç›®æ ‡çº¿ç¨‹ä¸èƒ½ running çš„ä¸»ä½“ï¼Œéƒ½æ˜¯å€™é€‰æ ¹å› **ï¼š

1. **å…¶ä»–é«˜ä¼˜å…ˆçº§çº¿ç¨‹**
   - å®æ—¶çº¿ç¨‹ï¼ˆä¼˜å…ˆçº§ < 100ï¼‰
   - CPU å¯†é›†å‹çº¿ç¨‹

2. **ä¸­æ–­ / è½¯ä¸­æ–­**
   - ç¡¬ä»¶ä¸­æ–­ï¼ˆirqï¼‰
   - è½¯ä¸­æ–­ï¼ˆsoftirqï¼‰
   - å·¥ä½œé˜Ÿåˆ—ï¼ˆworkqueueï¼‰

3. **é•¿æ—¶é—´è¿è¡Œçš„å†…æ ¸ä¸Šä¸‹æ–‡**
   - ç³»ç»Ÿè°ƒç”¨
   - å†…æ ¸çº¿ç¨‹

4. **é”å¯¼è‡´çš„è¢«åŠ¨é˜»å¡**
   - mutexã€spinlock
   - RCU ç­‰å¾…

**æ–¹æ³•è®ºè¦ç‚¹**ï¼š
> **ä¸æ‰¾"è°æœ€å¿™"ï¼Œåªæ‰¾"è°æŒ¡è·¯"**

**åˆ†æå‘½ä»¤**ï¼š
```bash
# è¯†åˆ«é˜»æ–­è€…
scripts/causality_chain.py trace.txt --victim myapp --window 1234.5,1237.8
```

---

### Step 5ï¼šæ„å»ºæœ€çŸ­å› æœé“¾

**æŠŠæ—¥å¿—å‹ç¼©æˆä¸€å¥è¯**ï¼š
> **å› ä¸º A åœ¨ T1 å‘ç”Ÿ â†’ å¯¼è‡´ B åœ¨ T2 å ç”¨ â†’ ä½¿ C åœ¨ T3 å»¶è¿Ÿ**

**ç¤ºä¾‹**ï¼š
```
å› ä¸º irq/28-GPU åœ¨ 1235.123s è§¦å‘ä¸­æ–­å¤„ç†
â†’ å¯¼è‡´ CPU 0 è¢«å ç”¨ 45ms
â†’ ä½¿ myapp åœ¨ 1235.168s è°ƒåº¦å»¶è¿Ÿè¾¾åˆ° 45ms
```

**å¦‚æœä¸€æ¡ç»“è®ºè§£é‡Šä¸äº†å¼‚å¸¸ï¼Œå°±ä¸æ˜¯æ ¹å› **ã€‚

**éªŒè¯æ–¹æ³•**ï¼š
1. æ—¶é—´æ˜¯å¦å»åˆï¼Ÿ
2. å»¶è¿Ÿé‡æ˜¯å¦åŒ¹é…ï¼Ÿ
3. èƒ½å¦è§£é‡Šæ•´ä¸ªå¼‚å¸¸æ—¶é—´çª—ï¼Ÿ
4. æ’é™¤å…¶ä»–å¯èƒ½æ€§äº†å—ï¼Ÿ

---

## å››ã€å…¸å‹é—®é¢˜çš„åˆ†ææ¨¡å‹

### 1ï¸âƒ£ å¡é¡¿ / å»¶è¿Ÿé—®é¢˜

**æ¨¡å‹**ï¼š
```
runnable ä½†é•¿æœŸæœª running
```

**å…³æ³¨çš„æ˜¯**ï¼š
- å»¶è¿Ÿçš„"é•¿åº¦"ï¼ˆç»å¯¹å€¼ï¼‰
- å»¶è¿ŸæœŸé—´ CPU çš„çœŸå®å ç”¨è€…

**åˆ†ææµç¨‹**ï¼š
```bash
# 1. æ‰¾åˆ°å»¶è¿Ÿå³°å€¼
scripts/sched_analyzer.py trace.txt --thread myapp

# 2. æŸ¥çœ‹å»¶è¿ŸæœŸé—´å‘ç”Ÿäº†ä»€ä¹ˆ
scripts/timeline_analyzer.py trace.txt --target myapp --context 50ms

# 3. è¯†åˆ«é˜»æ–­è€…
scripts/causality_chain.py trace.txt --victim myapp
```

**å…¸å‹æ ¹å› **ï¼š
- é«˜ä¼˜å…ˆçº§å®æ—¶çº¿ç¨‹æŠ¢å 
- ä¸­æ–­é£æš´
- é”ç­‰å¾…

---

### 2ï¸âƒ£ æŠ–åŠ¨ / ä¸ç¨³å®š

**æ¨¡å‹**ï¼š
```
é«˜é¢‘ wakeup + å¿«é€Ÿ sleep
```

**è¯´æ˜**ï¼š
- é€»è¾‘åœ¨"ç©ºè½¬"
- æˆ–è¢«å¤–éƒ¨äº‹ä»¶é¢‘ç¹æ‰“æ–­

**åˆ†ææŒ‡æ ‡**ï¼š
- wakeup é¢‘ç‡ï¼ˆ> 1000æ¬¡/ç§’ å¼‚å¸¸ï¼‰
- æ¯æ¬¡ running æ—¶é•¿ï¼ˆ< 1ms å¯ç–‘ï¼‰

**å…¸å‹æ ¹å› **ï¼š
- è½®è¯¢ç­‰å¾…ï¼ˆåº”æ”¹ä¸ºäº‹ä»¶é©±åŠ¨ï¼‰
- å¿™ç­‰å¾…é”
- é¢‘ç¹çš„ä¿¡å·æˆ–å®šæ—¶å™¨

---

### 3ï¸âƒ£ æ€§èƒ½é€€åŒ–

**æ¨¡å‹**ï¼š
```
å•æ¬¡ä¸æ…¢ï¼Œä½†ç´¯è®¡è€—æ—¶å¼‚å¸¸
```

**éœ€è¦**ï¼š
- èšåˆè§†è§’
- å¯¹æ¯”æ­£å¸¸åœºæ™¯çš„äº‹ä»¶å¯†åº¦

**åˆ†ææ–¹æ³•**ï¼š
```bash
# å¯¹æ¯”æ­£å¸¸å’Œå¼‚å¸¸åœºæ™¯
scripts/sched_analyzer.py normal.txt --summary > normal.json
scripts/sched_analyzer.py abnormal.txt --summary > abnormal.json
diff normal.json abnormal.json
```

**å…³æ³¨æŒ‡æ ‡**ï¼š
- ä¸Šä¸‹æ–‡åˆ‡æ¢æ¬¡æ•°ï¼ˆå¢åŠ  > 50% å¼‚å¸¸ï¼‰
- å¹³å‡æ—¶é—´ç‰‡ï¼ˆå‡å°‘ > 30% å¼‚å¸¸ï¼‰
- è°ƒåº¦å»¶è¿Ÿåˆ†å¸ƒå˜åŒ–

---

### 4ï¸âƒ£ é” / é˜»å¡

**æ¨¡å‹**ï¼š
```
ä¸»åŠ¨ä¸å¯è¿è¡Œï¼ˆéè°ƒåº¦é—®é¢˜ï¼‰
```

**æ–¹æ³•è®ºå…³é”®**ï¼š
> **åŒºåˆ†"æ²¡è½®åˆ°" vs "ä¸èƒ½è·‘"**

- "æ²¡è½®åˆ°"ï¼šrunnable çŠ¶æ€ï¼Œæ˜¯è°ƒåº¦é—®é¢˜
- "ä¸èƒ½è·‘"ï¼šblocked çŠ¶æ€ï¼ˆD/Sï¼‰ï¼Œæ˜¯é”/IO é—®é¢˜

**åˆ†æé‡ç‚¹**ï¼š
- è¿›å…¥ D çŠ¶æ€ï¼ˆä¸å¯ä¸­æ–­ç¡çœ ï¼‰
- é”äº‰ç”¨äº‹ä»¶ï¼ˆlock_acquire, lock_contendedï¼‰
- æŒé”æ—¶é—´

---

## äº”ã€å¯¹ç…§åˆ†æï¼šå¿…é¡»åšçš„äº‹

### ä¸ºä»€ä¹ˆéœ€è¦å¯¹ç…§ï¼Ÿ

**æ²¡æœ‰å¯¹ç…§çš„ ftraceï¼Œåªæ˜¯æ•…äº‹ï¼Œä¸æ˜¯è¯æ®**

å¯¹ç…§å¯ä»¥æ˜¯ï¼š
1. æ­£å¸¸åœºæ™¯ vs å¼‚å¸¸åœºæ™¯
2. é—®é¢˜å‰ vs é—®é¢˜å
3. ä¸åŒè´Ÿè½½ä¸‹çš„å¯¹æ¯”

### å¯¹æ¯”ä»€ä¹ˆï¼Ÿ

ä¸æ˜¯å¯¹æ¯”ç»å¯¹å€¼ï¼Œè€Œæ˜¯å¯¹æ¯”ï¼š

1. **è°ƒåº¦å»¶è¿Ÿåˆ†å¸ƒ**
   - å¹³å‡å€¼
   - æœ€å¤§å€¼
   - P99ã€P95 åˆ†ä½æ•°

2. **æŠ¢å æ¬¡æ•°**
   - æ€»æ¬¡æ•°
   - é¢‘ç‡

3. **å¹²æ‰°æºç±»å‹**
   - ä¸­æ–­å æ¯”
   - å®æ—¶çº¿ç¨‹å æ¯”
   - æ™®é€šçº¿ç¨‹å æ¯”

### å¯¹ç…§åˆ†æç¤ºä¾‹

```bash
# ç”Ÿæˆå¯¹ç…§æŠ¥å‘Š
scripts/sched_analyzer.py normal.txt --thread myapp --report-format json > normal.json
scripts/sched_analyzer.py problem.txt --thread myapp --report-format json > problem.json

# å¯¹æ¯”å…³é”®æŒ‡æ ‡
diff <(jq '.sched_latency' normal.json) <(jq '.sched_latency' problem.json)
```

**å…³é”®é—®é¢˜**ï¼š
- å“ªä¸ªæŒ‡æ ‡å˜åŒ–æœ€å¤§ï¼Ÿ
- å˜åŒ–æ˜¯å¦åœ¨é—®é¢˜æ—¶é—´çª—å†…ï¼Ÿ
- å˜åŒ–æ˜¯å¦æŒç»­å­˜åœ¨ï¼Ÿ

---

## å…­ã€ç»“è®ºè¾“å‡ºçš„æ ‡å‡†æ ¼å¼

**ä¸€ä¸ªåˆæ ¼çš„ ftrace ç»“è®ºå¿…é¡»åŒ…å«**ï¼š

### 1. å¼‚å¸¸è¡¨ç°ï¼ˆå¯é‡åŒ–ï¼‰

**å¥½çš„ä¾‹å­**ï¼š
```
çº¿ç¨‹ myapp-1234 çš„å¹³å‡è°ƒåº¦å»¶è¿Ÿä» 2.1ms å¢åŠ åˆ° 52.3ms
```

**åçš„ä¾‹å­**ï¼š
```
è°ƒåº¦æœ‰ç‚¹æ…¢ âŒ
```

### 2. ç›´æ¥åŸå› ï¼ˆè°æŒ¡äº†è·¯ï¼‰

**å¥½çš„ä¾‹å­**ï¼š
```
CPU 0 åœ¨å¼‚å¸¸æ—¶é—´çª—å†…è¢«å®æ—¶çº¿ç¨‹ irq/28-GPU æŒç»­å ç”¨
```

**åçš„ä¾‹å­**ï¼š
```
ç³»ç»Ÿè´Ÿè½½é«˜ âŒ
```

### 3. æœºåˆ¶è§£é‡Šï¼ˆä¸ºä»€ä¹ˆå®ƒèƒ½æŒ¡è·¯ï¼‰

**å¥½çš„ä¾‹å­**ï¼š
```
irq/28-GPU ä¼˜å…ˆçº§ä¸º 50ï¼ˆFIFOå®æ—¶ï¼‰ï¼Œé«˜äº myapp çš„ 120ï¼ˆæ™®é€šï¼‰ï¼Œ
å› æ­¤ myapp æ— æ³•æŠ¢å å…¶è¿è¡Œ
```

**åçš„ä¾‹å­**ï¼š
```
ä¼˜å…ˆçº§ä¸å¯¹ âŒ
```

### 4. æ’ä»–æ€§ï¼ˆä¸ºä»€ä¹ˆä¸æ˜¯åˆ«çš„åŸå› ï¼‰

**å¥½çš„ä¾‹å­**ï¼š
```
- ä¸­æ–­å»¶è¿Ÿæ­£å¸¸ï¼ˆ< 100usï¼‰
- é”äº‰ç”¨ä¸æ˜¾è‘—ï¼ˆ< 5% æ—¶é—´ï¼‰
- å…¶ä»– CPU è´Ÿè½½æ­£å¸¸
- æ’é™¤ä¸­æ–­ã€é”ã€è´Ÿè½½é—®é¢˜ï¼Œç¡®è®¤ä¸ºå®æ—¶çº¿ç¨‹æŠ¢å 
```

**åçš„ä¾‹å­**ï¼š
```
åº”è¯¥æ˜¯è¿™ä¸ªé—®é¢˜ âŒ
```

---

## ä¸ƒã€å¸¸è§é™·é˜±å’Œè¯¯åŒº

### âŒ é™·é˜± 1ï¼šè¢«äº‹ä»¶æ•°é‡"éœ‡æ…‘"

**é”™è¯¯æ€ç»´**ï¼š
"æ—¥å¿—æœ‰ 100 ä¸‡è¡Œï¼Œå¤ªå¤šäº†ï¼Œçœ‹ä¸è¿‡æ¥"

**æ­£ç¡®åšæ³•**ï¼š
1. å…ˆè¿‡æ»¤ï¼ˆCPU/è¿›ç¨‹/æ—¶é—´çª—ï¼‰
2. åªçœ‹å¼‚å¸¸æ—¶é—´çª—
3. åªçœ‹è°ƒåº¦ç›¸å…³äº‹ä»¶

### âŒ é™·é˜± 2ï¼šæŠŠå¹¶å‘å½“å› æœ

**é”™è¯¯æ€ç»´**ï¼š
"A å’Œ B åŒæ—¶å‘ç”Ÿï¼Œæ‰€ä»¥ A å¯¼è‡´äº† B"

**æ­£ç¡®åšæ³•**ï¼š
- æ£€æŸ¥æ—¶é—´å…ˆåé¡ºåº
- éªŒè¯å› æœæœºåˆ¶ï¼ˆA å¦‚ä½•å¯¼è‡´ Bï¼‰
- æ’é™¤ç¬¬ä¸‰æ–¹ C å¯¼è‡´ A å’Œ B

### âŒ é™·é˜± 3ï¼šè¿‡åº¦å…³æ³¨å‡½æ•°ç»†èŠ‚

**é”™è¯¯æ€ç»´**ï¼š
"è¿™é‡Œè°ƒç”¨äº† schedule()ï¼Œæ‰€ä»¥æ˜¯è°ƒåº¦å™¨çš„é—®é¢˜"

**æ­£ç¡®åšæ³•**ï¼š
- è°ƒåº¦æ˜¯ç»“æœï¼Œä¸æ˜¯åŸå› 
- é—®ï¼šä¸ºä»€ä¹ˆä¼šè°ƒç”¨ schedule()ï¼Ÿ
- é—®ï¼šè°ƒåº¦åˆ°å“ªé‡Œå»äº†ï¼Ÿ

### âŒ é™·é˜± 4ï¼šæ²¡æœ‰é‡åŒ–

**é”™è¯¯æ€ç»´**ï¼š
"è°ƒåº¦å»¶è¿Ÿæœ‰ç‚¹å¤§"

**æ­£ç¡®åšæ³•**ï¼š
- å…·ä½“æ•°å€¼ï¼š52.3ms
- å¯¹æ¯”åŸºå‡†ï¼šæ­£å¸¸ 2.1ms
- å˜åŒ–å¹…åº¦ï¼šå¢åŠ  24.9 å€

---

## å…«ã€ä¸€å¥è¯æ€»ç»“

> **ftrace çš„æœ¬è´¨ä¸æ˜¯æ—¥å¿—åˆ†æï¼Œè€Œæ˜¯"å†…æ ¸æ—¶åºæ¨ç†"**
> 
> ä½ ä¸æ˜¯åœ¨è¯» logï¼Œè€Œæ˜¯åœ¨**è¿˜åŸä¸€ä¸ªè¢«æ‰“ä¹±çš„å¹¶å‘æ•…äº‹**ã€‚

**è®°ä½**ï¼š
- æ—¶é—´æ˜¯ç¬¬ä¸€è¦ç´ 
- å› æœæ˜¯æ ¸å¿ƒé€»è¾‘  
- é‡åŒ–æ˜¯å”¯ä¸€æ ‡å‡†
- å¯¹ç…§æ˜¯å¿…è¦æ‰‹æ®µ
